<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="QnaMapper">

	<!-- <select id="selectList" resultType="qna">
		select q.*,t.name from qna q INNER JOIN tap t on q.tap=t.no order by q.no desc
	</select> -->

	<insert id="insertQna">
		insert into qna(no,id,tap,title,content)values((select nvl(max(no),0) + 1 from qna),#{id},#{tap},#{title},#{content} )
	</insert>
	
	<!-- 자유게시판 상세정보 가져오기 -->
	<select id="selectOne" resultType="qna" parameterType="qna">
		SELECT q.*,t.name
		FROM qna q INNER JOIN tap t on q.tap=t.no
		WHERE q.no = #{no}
	</select>
	
	<!-- 로넘으로 글가져오기 -->
	<select id="selectList" resultType="qna" parameterType="page">
		<![CDATA[
		SELECT *
		FROM (  SELECT ROWNUM rn, A.*,t.name
		        FROM (  SELECT *
		                FROM qna
		                ORDER BY day desc
		        ) A inner join tap t on a.tap=t.no
		    )
		WHERE rn >= #{startPage} and rn <= #{endPage}
		
		]]>
	</select>
	
	<select id="getTotal" resultType="int">
	SELECT count(*) as total
		FROM qna
	</select>
	
	<update id="updateQna">
		update qna set tap=#{tap},title=#{title},content=#{content} where no=#{no}
	</update>
	
	<update id="updateQnaCnt">
		update qna set cnt =
		cnt + 1 where no = #{no}
	</update>
	
	<delete id="deleteQna">
		DELETE FROM qna
		WHERE no = #{no}
	</delete>
</mapper>